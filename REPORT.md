# Детекция и сегментация людей на видео с использованием YOLO11

## 1. Введение

Цель проекта — разработать программу для детекции и сегментации людей на видео с помощью модели **YOLO11**.
Задачи проекта:

* Обнаружение людей на кадрах видео.
* Отрисовка боксов с уверенностью в распознавании.
* Анализ работы модели и рекомендация шагов по улучшению точности.

Входные данные: видео с людьми.
Выходные данные: видео с отрисованной боксовой аннотацией.

---

## 2. Архитектура решения

1. **Модель:** YOLO11 (`yolo11s.pt`), загруженная через `ultralytics.YOLO`.
2. **Прогон видео:** считывание кадров через OpenCV, детекция объектов на каждом кадре.
3. **Фильтрация по классу:** оставляем только объекты класса `person` (ID = 0 в COCO).
4. **Отрисовка результатов:** боксы с подписью confidence.
5. **Сохранение видео:** обработанные кадры сохраняются в новый файл.

---


## 3. Результаты работы на видео без аннотаций

1. **Обнаружение людей**

   * Модель корректно выявляет людей на кадрах с умеренной плотностью.
   * На плотной толпе возможны пропуски отдельных людей или частичное наложение боксов.

2. **Confidence score**

   * Средний confidence для большинства людей находится в диапазоне 0.6–0.8.

3. **Количество детекций на кадр**

   * Наблюдается корреляция между плотностью людей и количеством детекций.
   * Иногда модель пропускает людей в плотной толпе, но при этом минимизирует ложные срабатывания.

4. **Визуальная оценка**

   * Маски накладываются корректно на большинство объектов.
   * Ложные срабатывания редки, но могут появляться на предметах, похожих на людей (например, картина на видео) .

---

## 4. Ограничения

* Модель YOLO11 обучена на общем COCO датасете, поэтому может ошибаться в специфичных сценах (плотная толпа, плохое освещение).
* Без аннотированных данных невозможно получить строгие метрики mAP, precision и recall.
* Производительность на CPU низкая при видео высокого разрешения (>1080p).

---

## 5. Рекомендации по улучшению

1. **Использование более крупной модели**

   * `yolo11m` или `yolo11l` повышает точность распознавания и качество масок.

2. **Настройка threshold**

   * Фильтрация детекций с низким confidence (`>0.4–0.5`) снижает количество ложных срабатываний.

3. **Дообучение на собственных данных**

   * Разметка ключевых кадров с людьми, особенно в сложных сценах.

4. **Аугментации**

   * Можно попробовать изменить яркость, контрастность, масштабировать и поворачивать кадры для большей устойчивости модели к различным условиям.


5. **Анализ динамики**

   * Попробовать анализ при помощи скользящего окна по кадрам, подсчета количества людей, среднему confidence — поможет выявить проблемные сцены и без разметки.

---

## 6. Заключение

Программа демонстрирует:

* Высокую эффективность для базовой детекции людей.
* Возможность визуального контроля через боксы.
* Основание для дальнейшего улучшения через fine-tuning и аугментации.

Дальнейшие шаги:

* Сбор небольшой разметки для fine-tuning.
* Использование более крупных моделей YOLO11.
* Настройка threshold для стабильной работы в реальных видео.
